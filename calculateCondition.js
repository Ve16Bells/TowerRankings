var jsonStr = '{"CARM":{"Landing_Sturdiness":"80","Landing_Cleanliness":"65","Natural_Lighting":"100","Artificial_Lighting":"25","Staircase_Cleanliness":"80","Staircase_Sturdiness":"86.7","Railing_Sturdiness":"100","Number_Misaligned_Brick_Front":"0","Number_Misaligned_Brick_Right":"0","Number_Misaligned_Brick_Back":"0","Number_Misaligned_Brick_Left":"0","Frame material":"50","Frame_cleanliness":"60","Frame_warping":"NR","Frame_Overall_condition":"80","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"NR","Railing":"0","Bird_net_condition_front":"40","Bird_net_condition_right":"40","Bird_net_condition_back":"40","Bird_net_condition_left":"40","Calculated_vibration":"NR","Conservation_state":"70","Safety_cable":"40","Cracked_side":"0","Cleanliness":"NR","Discoloration":"NR","Overall_condition":"NR","Clapper_condition":"70","Belt_condition":"93.3","Inclination calculated":"NR","Inclination_rating":"NR"},"CASS":{"Landing_Sturdiness":"80","Landing_Cleanliness":"75","Natural_Lighting":"100","Artificial_Lighting":"100","Staircase_Cleanliness":"80","Staircase_Sturdiness":"80","Railing_Sturdiness":"80","Number_Misaligned_Brick_Front":"0","Number_Misaligned_Brick_Right":"0","Number_Misaligned_Brick_Back":"0","Number_Misaligned_Brick_Left":"0","Frame material":"50","Frame_cleanliness":"NR","Frame_warping":"NR","Frame_Overall_condition":"NR","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"NR","Railing":"NR","Bird_net_condition_front":"60","Bird_net_condition_right":"60","Bird_net_condition_back":"60","Bird_net_condition_left":"60","Calculated_vibration":"NR","Conservation_state":"NR","Safety_cable":"66","Cracked_side":"0","Cleanliness":"60","Discoloration":"2.5","Overall_condition":"NR","Clapper_condition":"70","Belt_condition":"70.333","Inclination calculated":"NR","Inclination_rating":"60"},"FRAR":{"Landing_Sturdiness":"80","Landing_Cleanliness":"80","Natural_Lighting":"100","Artificial_Lighting":"100","Staircase_Cleanliness":"80","Staircase_Sturdiness":"90","Railing_Sturdiness":"3","Number_Misaligned_Brick_Front":"1","Number_Misaligned_Brick_Right":"0","Number_Misaligned_Brick_Back":"0","Number_Misaligned_Brick_Left":"0","Frame material":"50","Frame_cleanliness":"NR","Frame_warping":"NR","Frame_Overall_condition":"NR","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"NR","Railing":"NR","Bird_net_condition_front":"NR","Bird_net_condition_right":"NR","Bird_net_condition_back":"NR","Bird_net_condition_left":"NR","Calculated_vibration":"NR","Conservation_state":"NR","Safety_cable":"NR","Cracked_side":"14.29","Cleanliness":"NR","Discoloration":"NR","Overall_condition":"NR","Clapper_condition":"NR","Belt_condition":"NR","Inclination calculated":"NR","Inclination_rating":"NR"},"GESU1":{"Landing_Sturdiness":"71.4","Landing_Cleanliness":"60","Natural_Lighting":"85.7","Artificial_Lighting":"85.7","Staircase_Cleanliness":"80","Staircase_Sturdiness":"60","Railing_Sturdiness":"80","Number_Misaligned_Brick_Front":"0","Number_Misaligned_Brick_Right":"1","Number_Misaligned_Brick_Back":"0","Number_Misaligned_Brick_Left":"0","Frame material":"50","Frame_cleanliness":"NR","Frame_warping":"NR","Frame_Overall_condition":"40","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"NR","Railing":"83.3","Bird_net_condition_front":"NR","Bird_net_condition_right":"NR","Bird_net_condition_back":"NR","Bird_net_condition_left":"NR","Calculated_vibration":"NR","Conservation_state":"40","Safety_cable":"100","Cracked_side":"0","Cleanliness":"53.3","Discoloration":"80","Overall_condition":"46.7","Clapper_condition":"40","Belt_condition":"45","Inclination calculated":"0","Inclination_rating":"20"},"MEND":{"Landing_Sturdiness":"97.1","Landing_Cleanliness":"60","Natural_Lighting":"100","Artificial_Lighting":"40","Staircase_Cleanliness":"66.7","Staircase_Sturdiness":"90","Railing_Sturdiness":"NR","Number_Misaligned_Brick_Front":"NR","Number_Misaligned_Brick_Right":"NR","Number_Misaligned_Brick_Back":"NR","Number_Misaligned_Brick_Left":"NR","Frame material":"50","Frame_cleanliness":"80","Frame_warping":"0","Frame_Overall_condition":"80","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"NR","Railing":"NR","Bird_net_condition_front":"60","Bird_net_condition_right":"60","Bird_net_condition_back":"60","Bird_net_condition_left":"60","Calculated_vibration":"NR","Conservation_state":"NR","Safety_cable":"NR","Cracked_side":"NR","Cleanliness":"80","Discoloration":"80","Overall_condition":"NR","Clapper_condition":"70","Belt_condition":"40","Inclination calculated":"2","Inclination_rating":"40"},"ORIO":{"Landing_Sturdiness":"84","Landing_Cleanliness":"74","Natural_Lighting":"100","Artificial_Lighting":"100","Staircase_Cleanliness":"82.2","Staircase_Sturdiness":"93.33","Railing_Sturdiness":"97.5","Number_Misaligned_Brick_Front":"0","Number_Misaligned_Brick_Right":"0","Number_Misaligned_Brick_Back":"0","Number_Misaligned_Brick_Left":"0","Frame material":"50","Frame_cleanliness":"80","Frame_warping":"NR","Frame_Overall_condition":"80","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"NR","Railing":"NR","Bird_net_condition_front":"100","Bird_net_condition_right":"100","Bird_net_condition_back":"100","Bird_net_condition_left":"100","Calculated_vibration":"NR","Conservation_state":"60","Safety_cable":"0","Cracked_side":"0","Cleanliness":"40","Discoloration":"100","Overall_condition":"NR","Clapper_condition":"40","Belt_condition":"60","Inclination calculated":"1","Inclination_rating":"40"},"PANT":{"Landing_Sturdiness":"92","Landing_Cleanliness":"88","Natural_Lighting":"100","Artificial_Lighting":"60","Staircase_Cleanliness":"85","Staircase_Sturdiness":"80","Railing_Sturdiness":"73.33","Number_Misaligned_Brick_Front":"0","Number_Misaligned_Brick_Right":"0","Number_Misaligned_Brick_Back":"0","Number_Misaligned_Brick_Left":"0","Frame material":"50","Frame_cleanliness":"100","Frame_warping":"0","Frame_Overall_condition":"100","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"80","Railing":"NR","Bird_net_condition_front":"100","Bird_net_condition_right":"100","Bird_net_condition_back":"100","Bird_net_condition_left":"100","Calculated_vibration":"NR","Conservation_state":"60","Safety_cable":"0","Cracked_side":"0","Cleanliness":"80","Discoloration":"60","Overall_condition":"NR","Clapper_condition":"100","Belt_condition":"100","Inclination calculated":"0","Inclination_rating":"20"},"RAFF1":{"Landing_Sturdiness":"90","Landing_Cleanliness":"90","Natural_Lighting":"33.33","Artificial_Lighting":"87.5","Staircase_Cleanliness":"60","Staircase_Sturdiness":"82.5","Railing_Sturdiness":"NR","Number_Misaligned_Brick_Front":"0","Number_Misaligned_Brick_Right":"0","Number_Misaligned_Brick_Back":"0","Number_Misaligned_Brick_Left":"0","Frame material":"50","Frame_cleanliness":"100","Frame_warping":"0","Frame_Overall_condition":"100","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"NR","Railing":"NR","Bird_net_condition_front":"100","Bird_net_condition_right":"100","Bird_net_condition_back":"100","Bird_net_condition_left":"100","Calculated_vibration":"NR","Conservation_state":"NR","Safety_cable":"NR","Cracked_side":"NR","Cleanliness":"55","Discoloration":"40","Overall_condition":"NR","Clapper_condition":"60","Belt_condition":"80","Inclination calculated":"NR","Inclination_rating":"NR"},"RAFF2":{"Landing_Sturdiness":"90","Landing_Cleanliness":"90","Natural_Lighting":"33.3","Artificial_Lighting":"87.5","Staircase_Cleanliness":"60","Staircase_Sturdiness":"82.857","Railing_Sturdiness":"NR","Number_Misaligned_Brick_Front":"0","Number_Misaligned_Brick_Right":"0","Number_Misaligned_Brick_Back":"0","Number_Misaligned_Brick_Left":"0","Frame material":"50","Frame_cleanliness":"100","Frame_warping":"0","Frame_Overall_condition":"100","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"NR","Railing":"NR","Bird_net_condition_front":"100","Bird_net_condition_right":"100","Bird_net_condition_back":"100","Bird_net_condition_left":"100","Calculated_vibration":"NR","Conservation_state":"NR","Safety_cable":"NR","Cracked_side":"33.3","Cleanliness":"60","Discoloration":"40","Overall_condition":"NR","Clapper_condition":"NR","Belt_condition":"93.3","Inclination calculated":"NR","Inclination_rating":"NR"},"SALU1":{"Landing_Sturdiness":"100","Landing_Cleanliness":"100","Natural_Lighting":"100","Artificial_Lighting":"100","Staircase_Cleanliness":"80","Staircase_Sturdiness":"100","Railing_Sturdiness":"NR","Number_Misaligned_Brick_Front":"NR","Number_Misaligned_Brick_Right":"NR","Number_Misaligned_Brick_Back":"NR","Number_Misaligned_Brick_Left":"NR","Frame material":"50","Frame_cleanliness":"60","Frame_warping":"NR","Frame_Overall_condition":"60","Condition_of_inside_of_roof":"60","Drain Holes Rating":"NR","Railing":"NR","Bird_net_condition_front":"100","Bird_net_condition_right":"100","Bird_net_condition_back":"100","Bird_net_condition_left":"100","Calculated_vibration":"NR","Conservation_state":"80","Safety_cable":"100","Cracked_side":"0","Cleanliness":"100","Discoloration":"20","Overall_condition":"100","Clapper_condition":"60","Belt_condition":"70","Inclination calculated":"0","Inclination_rating":"20"},"SEBA":{"Landing_Sturdiness":"90","Landing_Cleanliness":"60","Natural_Lighting":"100","Artificial_Lighting":"33.33","Staircase_Cleanliness":"80","Staircase_Sturdiness":"90","Railing_Sturdiness":"100","Number_Misaligned_Brick_Front":"0","Number_Misaligned_Brick_Right":"0","Number_Misaligned_Brick_Back":"0","Number_Misaligned_Brick_Left":"0","Frame material":"50","Frame_cleanliness":"40","Frame_warping":"0","Frame_Overall_condition":"60","Condition_of_inside_of_roof":"60","Drain Holes Rating":"60","Railing":"NR","Bird_net_condition_front":"100","Bird_net_condition_right":"100","Bird_net_condition_back":"100","Bird_net_condition_left":"100","Calculated_vibration":"NR","Conservation_state":"60","Safety_cable":"100","Cracked_side":"0","Cleanliness":"45","Discoloration":"80","Overall_condition":"46.7","Clapper_condition":"50","Belt_condition":"50","Inclination calculated":"1","Inclination_rating":"40"},"SILV":{"Landing_Sturdiness":"91.4285714","Landing_Cleanliness":"80","Natural_Lighting":"100","Artificial_Lighting":"0","Staircase_Cleanliness":"73.333","Staircase_Sturdiness":"83.333","Railing_Sturdiness":"100","Number_Misaligned_Brick_Front":"0","Number_Misaligned_Brick_Right":"3","Number_Misaligned_Brick_Back":"0","Number_Misaligned_Brick_Left":"4","Frame material":"50","Frame_cleanliness":"80","Frame_warping":"NR","Frame_Overall_condition":"80","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"60","Railing":"NR","Bird_net_condition_front":"NR","Bird_net_condition_right":"NR","Bird_net_condition_back":"NR","Bird_net_condition_left":"NR","Calculated_vibration":"NR","Conservation_state":"65","Safety_cable":"75","Cracked_side":"0","Cleanliness":"75","Discoloration":"80","Overall_condition":"55","Clapper_condition":"60","Belt_condition":"70","Inclination calculated":"NR","Inclination_rating":"NR"},"SIMG":{"Landing_Sturdiness":"60","Landing_Cleanliness":"40","Natural_Lighting":"100","Artificial_Lighting":"0","Staircase_Cleanliness":"20","Staircase_Sturdiness":"20","Railing_Sturdiness":"NR","Number_Misaligned_Brick_Front":"NR","Number_Misaligned_Brick_Right":"NR","Number_Misaligned_Brick_Back":"NR","Number_Misaligned_Brick_Left":"NR","Frame material":"50","Frame_cleanliness":"NR","Frame_warping":"NR","Frame_Overall_condition":"NR","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"NR","Railing":"NR","Bird_net_condition_front":"80","Bird_net_condition_right":"80","Bird_net_condition_back":"80","Bird_net_condition_left":"80","Calculated_vibration":"NR","Conservation_state":"NR","Safety_cable":"NR","Cracked_side":"NR","Cleanliness":"NR","Discoloration":"NR","Overall_condition":"NR","Clapper_condition":"NR","Belt_condition":"NR","Inclination calculated":"NR","Inclination_rating":"NR"},"SIMP":{"Landing_Sturdiness":"84","Landing_Cleanliness":"40","Natural_Lighting":"100","Artificial_Lighting":"0","Staircase_Cleanliness":"20","Staircase_Sturdiness":"60","Railing_Sturdiness":"60","Number_Misaligned_Brick_Front":"NR","Number_Misaligned_Brick_Right":"NR","Number_Misaligned_Brick_Back":"NR","Number_Misaligned_Brick_Left":"NR","Frame material":"100","Frame_cleanliness":"NR","Frame_warping":"NR","Frame_Overall_condition":"NR","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"NR","Railing":"NR","Bird_net_condition_front":"80","Bird_net_condition_right":"80","Bird_net_condition_back":"80","Bird_net_condition_left":"80","Calculated_vibration":"NR","Conservation_state":"NR","Safety_cable":"NR","Cracked_side":"0","Cleanliness":"20","Discoloration":"70","Overall_condition":"NR","Clapper_condition":"NR","Belt_condition":"NR","Inclination calculated":"NR","Inclination_rating":"NR"},"STAE":{"Landing_Sturdiness":"82.5","Landing_Cleanliness":"75","Natural_Lighting":"100","Artificial_Lighting":"87.5","Staircase_Cleanliness":"80","Staircase_Sturdiness":"85.7142857","Railing_Sturdiness":"91.4285714","Number_Misaligned_Brick_Front":"0","Number_Misaligned_Brick_Right":"0","Number_Misaligned_Brick_Back":"0","Number_Misaligned_Brick_Left":"0","Frame material":"75","Frame_cleanliness":"NR","Frame_warping":"NR","Frame_Overall_condition":"60","Condition_of_inside_of_roof":"60","Drain Holes Rating":"40","Railing":"NR","Bird_net_condition_front":"80","Bird_net_condition_right":"80","Bird_net_condition_back":"80","Bird_net_condition_left":"80","Calculated_vibration":"NR","Conservation_state":"NR","Safety_cable":"0","Cracked_side":"0","Cleanliness":"46.667","Discoloration":"40","Overall_condition":"46.667","Clapper_condition":"40","Belt_condition":"NR","Inclination calculated":"NR","Inclination_rating":"NR"},"TOLE":{"Landing_Sturdiness":"90","Landing_Cleanliness":"80","Natural_Lighting":"75","Artificial_Lighting":"100","Staircase_Cleanliness":"80","Staircase_Sturdiness":"80","Railing_Sturdiness":"95","Number_Misaligned_Brick_Front":"0","Number_Misaligned_Brick_Right":"1","Number_Misaligned_Brick_Back":"1","Number_Misaligned_Brick_Left":"0","Frame material":"50","Frame_cleanliness":"80","Frame_warping":"0","Frame_Overall_condition":"NR","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"NR","Railing":"NR","Bird_net_condition_front":"NR","Bird_net_condition_right":"NR","Bird_net_condition_back":"NR","Bird_net_condition_left":"NR","Calculated_vibration":"NR","Conservation_state":"4","Safety_cable":"0","Cracked_side":"0","Cleanliness":"80","Discoloration":"60","Overall_condition":"73.333","Clapper_condition":"NR","Belt_condition":"NR","Inclination calculated":"0","Inclination_rating":"20"},"TROV":{"Landing_Sturdiness":"100","Landing_Cleanliness":"40","Natural_Lighting":"100","Artificial_Lighting":"NR","Staircase_Cleanliness":"60","Staircase_Sturdiness":"60","Railing_Sturdiness":"NR","Number_Misaligned_Brick_Front":"NR","Number_Misaligned_Brick_Right":"NR","Number_Misaligned_Brick_Back":"NR","Number_Misaligned_Brick_Left":"NR","Frame material":"50","Frame_cleanliness":"100","Frame_warping":"100","Frame_Overall_condition":"100","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"NR","Railing":"NR","Bird_net_condition_front":"80","Bird_net_condition_right":"80","Bird_net_condition_back":"80","Bird_net_condition_left":"80","Calculated_vibration":"NR","Conservation_state":"NR","Safety_cable":"0","Cracked_side":"NR","Cleanliness":"80","Discoloration":"73.333","Overall_condition":"60","Clapper_condition":"NR","Belt_condition":"NR","Inclination calculated":"NR","Inclination_rating":"60"},"ZAND":{"Landing_Sturdiness":"92","Landing_Cleanliness":"84","Natural_Lighting":"40","Artificial_Lighting":"80","Staircase_Cleanliness":"85","Staircase_Sturdiness":"100","Railing_Sturdiness":"100","Number_Misaligned_Brick_Front":"0","Number_Misaligned_Brick_Right":"0","Number_Misaligned_Brick_Back":"0","Number_Misaligned_Brick_Left":"0","Frame material":"50","Frame_cleanliness":"80","Frame_warping":"0","Frame_Overall_condition":"NR","Condition_of_inside_of_roof":"NR","Drain Holes Rating":"NR","Railing":"NR","Bird_net_condition_front":"40","Bird_net_condition_right":"40","Bird_net_condition_back":"40","Bird_net_condition_left":"40","Calculated_vibration":"NR","Conservation_state":"NR","Safety_cable":"0","Cracked_side":"0","Cleanliness":"80","Discoloration":"100","Overall_condition":"40","Clapper_condition":"NR","Belt_condition":"NR","Inclination calculated":"NR","Inclination_rating":"NR"}}';

weightsAssArray = {
	"Landing_Sturdiness" : "2",
	"Landing_Cleanliness" : "1",
	"Natural_Lighting" : "0.4",
	"Artificial_Lighting" : "0.1",
	"Staircase_Cleanliness" : "1",
	"Staircase_Sturdiness" : "2",
	"Railing_Sturdiness" : "2",
	"Number_Misaligned_Brick_Front" : "0.25",
	"Number_Misaligned_Brick_Right" : "0.25",
	"Number_Misaligned_Brick_Back" : "0.25",
	"Number_Misaligned_Brick_Left" : "0.25",
	"Frame material" : "1",
	"Frame_cleanliness" : "1",
	"Frame_warping" : "0.1",
	"Frame_Overall_condition" : "2",
	"Condition_of_inside_of_roof" : "0.5",
	"Drain Holes Rating" : "1",
	"Railing" : "2",
	"Bird_net_condition_front" : "2",
	// "Bird_net_condition_right" : "1.25",
	// "Bird_net_condition_back" : "1.25",
	// "Bird_net_condition_left" : "1.25",
	"Calculated_vibration" : "1",

	"Conservation_state" : "1",
	"Safety_cable" : "1",
	"Cracked_side" : "2",
	"Cleanliness" : "1",
	"Discoloration" : "0.2",
	"Overall_condition" : "2",
	"Clapper_condition" : "0.5",
	"Belt_condition" : "0.5",

	// "Inclination calculated" : "1",
	"Inclination_rating" : "1"
};

BellFields = {
	"Conservation_state" : "1",
	"Safety_cable" : "1",
	"Cracked_side" : "2",
	"Cleanliness" : "1",
	"Discoloration" : "0.2",
	"Overall_condition" : "2",
	"Clapper_condition" : "0.5",
	"Belt_condition" : "0.5"
};

BelfryFields = {
	"Landing_Cleanliness" : "1",
	"Frame material" : "1",
	"Frame_cleanliness" : "1",
	"Frame_warping" : "0.1",
	"Frame_Overall_condition" : "2",
	"Condition_of_inside_of_roof" : "0.5",
	"Drain Holes Rating" : "1",
	"Bird_net_condition_front" : "2"
};

LandingFields = {
	"Landing_Sturdiness" : "2",
	"Landing_Cleanliness" : "1",
	"Natural_Lighting" : "0.4",
	"Artificial_Lighting" : "0.1",
	"Staircase_Cleanliness" : "1",
	"Staircase_Sturdiness" : "2",
	"Railing_Sturdiness" : "2",
	"Railing" : "2",
	"Number_Misaligned_Brick_Front" : "0.25",
	"Number_Misaligned_Brick_Right" : "0.25",
	"Number_Misaligned_Brick_Back" : "0.25",
	"Number_Misaligned_Brick_Left" : "0.25"
};

ExternalFields = {
	// "Inclination calculated" : "1",
	"Inclination_rating" : "1"
};

var conditionObj = JSON.parse(jsonStr);
calculateRankings(conditionObj);


// FUNCTIONS * FUNCTIONS * FUNCTIONS * FUNCTIONS * FUNCTIONS * FUNCTIONS * FUNCTIONS
function calculateRankings(objOfAllConditions) {
	console.log('* * * * * * * * * * * * * * * * * * * * * * * * * * * * * *')
	for (var towerId in objOfAllConditions) {
		if (objOfAllConditions.hasOwnProperty(towerId)) {
			var rankOfTower = {"tower_id": towerId};
			rankOfTower['overall_condition'] = calculateTowerCondition(objOfAllConditions[towerId]);
			rankOfTower['bell_condition'] = calculateSectionCondition(objOfAllConditions[towerId], BellFields);
			rankOfTower['belfry_condition'] = calculateSectionCondition(objOfAllConditions[towerId], BelfryFields);
			rankOfTower['landings_condition'] = calculateSectionCondition(objOfAllConditions[towerId], LandingFields);
			rankOfTower['external_condition'] = calculateSectionCondition(objOfAllConditions[towerId], ExternalFields);

			describeTower(rankOfTower);
		}
	}
}

function describeTower(rankingsOfTower) {
	var description = rankingsOfTower['tower_id'];
	description += '\n   overall condition: ' + rankingsOfTower['overall_condition'];
	description += '\n      bell condition: ' + rankingsOfTower['bell_condition'];
	description += '\n    belfry condition: ' + rankingsOfTower['belfry_condition'];
	description += '\n  landings condition: ' + rankingsOfTower['landings_condition'];
	description += '\n  external condition: ' + rankingsOfTower['external_condition'];
	description += '\n\n';

	console.log(description);
}


function calculateTowerCondition(towerCondition) {
	var total = 0;
	var count = 0;
	var weightCount = 0;
	var outputString = ""

	for (var key in weightsAssArray) {
		if (weightsAssArray.hasOwnProperty(key)) {
			if (towerCondition[key] != 'NR') {
				// console.log(towerCondition[key], weightsAssArray[key]);
				count += 1;
				weightCount += parseFloat(weightsAssArray[key]);
				var tweakedVal = getTweakedVal(key, towerCondition[key]);
				outputString += '\n' + key + '\t\t|val: ' + towerCondition[key] + '\t\t|weighted val: ' + getWeightedValue(tweakedVal.toString(), weightsAssArray[key]);
    			total += getWeightedValue(tweakedVal.toString(), weightsAssArray[key]);
			}
    	}
	}

	// console.log(outputString);
	// console.log("\ntotal:", total);
	// console.log("averaged total: ",total / count);
	// console.log("averaged total using weighted count: ", total / weightCount);

	return total / weightCount;
	// return total;
}

function calculateSectionCondition(towerCondition, listOfFields) {
	var total = 0;
	var count = 0;
	var weightCount = 0;
	var outputString = ""

	for (var key in weightsAssArray) {
		if (weightsAssArray.hasOwnProperty(key) && listOfFields.hasOwnProperty(key)) {
			if (towerCondition[key] != 'NR') {
				// console.log(towerCondition[key], weightsAssArray[key]);
				count += 1;
				weightCount += parseFloat(weightsAssArray[key]);
				var tweakedVal = getTweakedVal(key, towerCondition[key]);
				outputString += '\n' + key + '\t\t|val: ' + towerCondition[key] + '\t\t|weighted val: ' + getWeightedValue(tweakedVal.toString(), weightsAssArray[key]);
    			total += getWeightedValue(tweakedVal.toString(), weightsAssArray[key]);
			}
    	}
	}

	// console.log(outputString);
	// console.log("\ntotal:", total);
	// console.log("averaged total: ",total / count);
	// console.log("averaged total using weighted count: ", total / weightCount);

	return total / weightCount;
	// return total;
}

/*** 
	100 is the best condition so if fields rank in the 
	opposite way their values need to be flipped. For 
	example Frame_warping is ranked where the higher 
	number means worst warping.
*/
function getTweakedVal(field, valStr) {
	var val = parseFloat(valStr);

	if (field == 'Frame_warping' || field == 'Discoloration'|| field == 'Cracked_side' ||
		field == 'Number_Misaligned_Brick_Front' || field == 'Number_Misaligned_Brick_Back'||
		field == 'Number_Misaligned_Brick_Left' || field == 'Number_Misaligned_Brick_Right' ||
		field == 'Inclination_rating') {
		// console.log('flipped val of', field, 'to', 100 - val);
		return 100 - val;
	}

	return val
}

function getWeightedValue(valStr, weightStr) {
	var val = parseFloat(valStr);
	var weight = parseFloat(weightStr);

	return weight * val;
}









